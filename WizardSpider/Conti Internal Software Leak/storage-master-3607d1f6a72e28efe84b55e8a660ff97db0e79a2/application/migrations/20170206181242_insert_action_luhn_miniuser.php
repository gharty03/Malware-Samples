<?php defined('SYSPATH') or die('No direct script access.');

class insert_action_luhn_miniuser extends Migration
{
    public function up(){
        $action = ORM::factory('Action', ['name' => 'Luhn']);
        $role = ORM::factory('Role', ['name' => 'mini-user']);
        $role->add('actions', $action);
    }

    public function down(){
        $action = ORM::factory('Action', ['name' => 'Luhn']);
        $role = ORM::factory('Role', ['name' => 'mini-user']);

        $action_roles = ORM::factory('Action_Role')
            ->where('action_id', '=', $action->id)
            ->and_where('role_id', '=', $role->id)
            ->find_all();
        foreach($action_roles as $action_role) {
            $action_role->delete();
        }
    }
}