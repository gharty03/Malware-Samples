<?php defined('SYSPATH') or die('No direct script access.');

class Task_Search_Client extends Minion_Task {
	protected function _execute(array $params){
        Task_Helper::createWorker('Search::Client', $this);
	}

    public function Worker(GearmanJob $job){
        $client = $job->workload();

        $sphinxql = new SphinxQL();

        $query = $sphinxql->new_query()
            ->add_index('clients')
            ->search("@client ".$client)
            ->execute();
        if(!empty($query['data'])){
            return $client;
        }

        return false;
    }
}