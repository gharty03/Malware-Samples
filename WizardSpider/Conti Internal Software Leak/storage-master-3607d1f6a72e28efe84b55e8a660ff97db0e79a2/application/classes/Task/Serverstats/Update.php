<?php defined('SYSPATH') or die('No direct script access.');

class Task_Serverstats_Update extends Minion_Task
{
    
	protected function _execute(array $params)
    {
        $gearman = Task_Helper::getClient();
        $gearman->addTaskLowBackground('Serverstats:Update:Uptime', '_', null, 'Serverstats:Update:Uptime');
        $gearman->addTaskLowBackground('Serverstats:Update:CountClientsDbEstimate', '_', null, 'Serverstats:Update:CountClientsDbEstimate');
        $gearman->addTaskLowBackground('Serverstats:Update:CountLogpostsDbEstimate', '_', null, 'Serverstats:Update:CountLogpostsDbEstimate');
        $gearman->addTaskLowBackground('Serverstats:Update:LocalSphinxStatus', '_', null, 'Serverstats:Update:LocalSphinxStatus');
        $gearman->addTaskLowBackground('Serverstats:Update:CountClientsSphinx', '_', null, 'Serverstats:Update:CountClientsSphinx');
        $gearman->addTaskLowBackground('Serverstats:Update:CountLogpostsSphinx', '_', null, 'Serverstats:Update:CountLogpostsSphinx');
        $gearman->addTaskLowBackground('Serverstats:Update:CountImport', '_', null, 'Serverstats:Update:CountImport');
        $gearman->runTasks();

        sleep(60);
    }
    
}