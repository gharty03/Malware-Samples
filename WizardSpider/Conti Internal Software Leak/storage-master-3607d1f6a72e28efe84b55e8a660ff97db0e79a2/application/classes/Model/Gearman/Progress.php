<?php defined('SYSPATH') or die('No direct script access.');

class Model_Gearman_Progress extends ORM {
	protected $_primary_key = 'worker';
	protected $_table_name = 'progress';
	protected $_table_columns = array(
		'worker' => NULL,
		'total' => NULL,
		'current' => NULL,
		'status' => NULL,
	);

	public function stop(){
		$user_id = Auth::instance()->get_user()->id;
		$progress = ORM::factory('Gearman_Progress')
//			->where('user_id', '=', $user_id)
			->where('worker', '=', 'Filter')
			->find();
		if($progress->loaded()){
			$progress->status = 'STOP';
			$progress->update();
		}
	}
}

