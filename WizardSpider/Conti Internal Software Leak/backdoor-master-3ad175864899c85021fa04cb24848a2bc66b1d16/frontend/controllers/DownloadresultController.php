<?php

namespace frontend\controllers;

use Yii;
use yii\web\Controller;
use yii\web\NotFoundHttpException;
use common\models\Commands;
use yii\helpers\Url;

class DownloadresultController extends Controller
{
    

    /**
     * Lists all Bots models.
     * @return mixed
     */
    public function actionIndex()
    {
        if (Yii::$app->user->isGuest) {
            return $this->goHome();
        }
        $request = Yii::$app->request->queryParams;
        $mod = Commands::findOne($request['id']);
        header('Content-Description: File Transfer');
        header('Content-Type: application/octet-stream');
        header('Content-Disposition: attachment; filename=Command-'.$mod->id.'-'.$mod->bot_id.'.conf');
        header('Content-Transfer-Encoding: binary');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Pragma: public');
        header('Content-Length: ' . strlen($mod->result));
        ob_start();
        echo $mod->result;
    }

}
